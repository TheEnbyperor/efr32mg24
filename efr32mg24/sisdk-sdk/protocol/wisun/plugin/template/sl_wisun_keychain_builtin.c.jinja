{{ autogenerated_c_file }}

{# Input validation -#}
{# Validate that names and handlers are defined -#}
{%- for iter in wisun_keychain_include -%}
  {%- if not iter.path -%}
    {{ raise("Missing path in wisun_keychain_include entry") }}
  {%- endif -%}
{%- endfor -%}
{%- for iter in wisun_keychain_trustedca -%}
  {%- if not iter.certificate -%}
    {{ raise("Missing certificate in wisun_keychain_trustedca entry") }}
  {%- endif -%}
{%- endfor -%}
{%- for iter in wisun_keychain_credential -%}
  {%- if not iter.certificate -%}
    {{ raise("Missing certificate in wisun_keychain_credential entry") }}
  {%- endif -%}
  {%- if not iter.key -%}
    {{ raise("Missing key in wisun_keychain_credential entry") }}
  {%- endif -%}
{%- endfor -%}

#include <stdint.h>
#include <stdlib.h>
#include "sl_wisun_keychain.h"
{%- for iter in wisun_keychain_include %}
#include "{{ iter.path }}"
{%- endfor %}

const uint32_t sl_wisun_keychain_builtin_trustedca_count = {{ wisun_keychain_trustedca|length }};
const sl_wisun_keychain_entry_t sl_wisun_keychain_builtin_trustedca[] = {{ '{' }}
{%- for iter in wisun_keychain_trustedca %}
  {{ '{' }} {{ iter.certificate }}, sizeof({{ iter.certificate }}) {{ '}' }},
{%- endfor %}
  {{ '{ NULL, 0 }' }}
{{ '};' }}

const uint32_t sl_wisun_keychain_builtin_devicecert_count = {{ wisun_keychain_credential|length }};
const sl_wisun_keychain_entry_t sl_wisun_keychain_builtin_devicecert[] = {{ '{' }}
{%- for iter in wisun_keychain_credential %}
  {{ '{' }} {{ iter.certificate }}, sizeof({{ iter.certificate }}) {{ '}' }},
{%- endfor %}
  {{ '{ NULL, 0 }' }}
{{ '};' }}

const uint32_t sl_wisun_keychain_builtin_devicekey_count = {{ wisun_keychain_credential|length }};
const sl_wisun_keychain_entry_t sl_wisun_keychain_builtin_devicekey[] = {{ '{' }}
{%- for iter in wisun_keychain_credential %}
  {{ '{' }} {{ iter.key }}, sizeof({{ iter.key }}) {{ '}' }},
{%- endfor %}
  {{ '{ NULL, 0 }' }}
{{ '};' }}
